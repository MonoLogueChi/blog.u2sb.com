import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,a,o as e}from"./app-CBSaRax9.js";const l={};function t(p,s){return e(),i("div",null,s[0]||(s[0]=[a(`<p>昨天给博客加了一个下载 MarkDown 文件的功能，原本是很简单的一件事，但是中间涉及到了很多麻烦东西，所以就决定简单记录以下。</p><h2 id="起因" tabindex="-1"><a class="header-anchor" href="#起因"><span>起因</span></a></h2><p>这件事的起因是前两天我写的一篇文章意外火了一遍，引来了一大波 PV，又有很多人转了这篇文章，还有人问我要 MarkDown 源文件。受到<a href="https://imququ.com/post/about.html" target="_blank" rel="noopener noreferrer">Jerry Qu 的小站</a>的启发，决定做一个 MarkDown 文件下载的功能。</p><h2 id="捋一下过程" tabindex="-1"><a class="header-anchor" href="#捋一下过程"><span>捋一下过程</span></a></h2><h3 id="hexo-修改部分" tabindex="-1"><a class="header-anchor" href="#hexo-修改部分"><span>Hexo 修改部分</span></a></h3><p><strong>本文介绍修改方法仅使用于 Yilia 主题，其他主题请参考原理，自行寻找食用方法</strong></p><p>修改\\layout_partial\\post\\nav.ejs，我找了好久才发现加在这里最合适，由于技术比较渣，暂时只能做到这样了，以后会继续进步的。</p><p>在<code>&lt;% if (post.next){ %&gt; … &lt;% } %&gt;</code>和<code>&lt;/nav&gt;</code>之间添加</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">&lt;%</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">theme</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">mdhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){ </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">%&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">br</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&lt;%- url_for(theme.mdhost) %&gt;&lt;%- url_for(post.path) %&gt;.txt&quot;</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> target</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;_blank&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;获取文章MarkDown文件&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;% } %&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 Yilia 主题的<code>_config.yml</code>中添加</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">mdhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#MarkDown文件下载地址,如：http://md.xxwhite.com/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这样点击下面的按钮的时候，就会调到同名的 txt 文件了。</p><p>比如这篇文章，点击获取 MarkDown 文件，就会跳转到页面<code>http://md.xxwhite.xom/2018/add-download-markdown.txt</code></p><h3 id="markdown-文件" tabindex="-1"><a class="header-anchor" href="#markdown-文件"><span>MarkDown 文件</span></a></h3><p>MarkDown 文件我是传到了网易云的对象存储服务中，如果要是把文件传到相同位置，那就更简单了（我接下来就是打算要这么做的，不闲着蛋疼去薅羊毛了）</p><p>首先是要把 MarKDown 文件转码为 ANSI，UTF-8 会乱码，不是自己搭的服务，请求头没办法改，接下来要改后缀为.txt，.md 默认 Content-Type 为 application/octet-stream，会自动变成下载。</p><p>我使用一个批处理自动化完成这个东西</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd D:\\MonoLogueChi\\Documents\\Hexo\\blog-md\\</span></span>
<span class="line"><span>del /S /Q .\\*</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Xcopy /Y /S D:\\MonoLogueChi\\Documents\\Hexo\\blog\\source\\_posts\\* D:\\MonoLogueChi\\Documents\\Hexo\\blog-md</span></span>
<span class="line"><span></span></span>
<span class="line"><span>for %%i in (*.md) do (</span></span>
<span class="line"><span>  iconv -f UTF-8 -t GBK %%i &gt; %%i.b</span></span>
<span class="line"><span>  if exist %%i.b (</span></span>
<span class="line"><span>    del %%i</span></span>
<span class="line"><span>    ren %%i.b %%~nxi</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>ren *.md *.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd .\\2017\\</span></span>
<span class="line"><span>for %%i in (*.md) do (</span></span>
<span class="line"><span>  iconv -f UTF-8 -t GBK %%i &gt; %%i.b</span></span>
<span class="line"><span>  if exist %%i.b (</span></span>
<span class="line"><span>    del %%i</span></span>
<span class="line"><span>    ren %%i.b %%~nxi</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>ren *.md *.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd ..\\2018\\</span></span>
<span class="line"><span>for %%i in (*.md) do (</span></span>
<span class="line"><span>  iconv -f UTF-8 -t GBK %%i &gt; %%i.b</span></span>
<span class="line"><span>  if exist %%i.b (</span></span>
<span class="line"><span>    del %%i</span></span>
<span class="line"><span>    ren %%i.b %%~nxi</span></span>
<span class="line"><span>  )</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>ren *.md *.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd /d %~dp0</span></span>
<span class="line"><span>pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个用到了 iconv.exe 这个东西，可以在这里下载 <a href="https://t1.aixinxi.net/o_1c5fbqvmj3u11pp6ml5v6dnfa.7z" target="_blank" rel="noopener noreferrer">iconv.7z</a></p><p>后面再加上自动上传就可以啦，很简单的一步式操作。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>tool.bat -putfile D:\\MonoLogueChi\\Documents\\Hexo\\blog-md &lt;你的桶名称&gt; -replace true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="写在后面的" tabindex="-1"><a class="header-anchor" href="#写在后面的"><span>写在后面的</span></a></h2><p>目前技术比较渣，暂时只能写到这样了，如果有什么更好的想法发话，欢迎在下面的评论区一起讨论。</p>`,23)]))}const o=n(l,[["render",t]]),h=JSON.parse('{"path":"/2018/0203.add-download-markdown.html","title":"增加一个MarkDown文件下载功能","lang":"zh-CN","frontmatter":{"title":"增加一个MarkDown文件下载功能","date":"2018-02-03T16:10:01.000Z","tag":["建站笔记"],"comments":true,"redirectFrom":["/2018/add-download-markdown.html"],"description":"昨天给博客加了一个下载 MarkDown 文件的功能，原本是很简单的一件事，但是中间涉及到了很多麻烦东西，所以就决定简单记录以下。","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"增加一个MarkDown文件下载功能\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2018-02-03T16:10:01.000Z\\",\\"dateModified\\":\\"2025-04-16T16:28:24.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MonoLogueChi\\",\\"url\\":\\"https://blog.u2sb.com\\"}]}"],["meta",{"property":"og:url","content":"https://blog.u2sb.com/2018/0203.add-download-markdown.html"}],["meta",{"property":"og:site_name","content":"叉叉白"}],["meta",{"property":"og:title","content":"增加一个MarkDown文件下载功能"}],["meta",{"property":"og:description","content":"昨天给博客加了一个下载 MarkDown 文件的功能，原本是很简单的一件事，但是中间涉及到了很多麻烦东西，所以就决定简单记录以下。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-16T16:28:24.000Z"}],["meta",{"property":"article:tag","content":"建站笔记"}],["meta",{"property":"article:published_time","content":"2018-02-03T16:10:01.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-16T16:28:24.000Z"}]]},"git":{"createdTime":1744820904000,"updatedTime":1744820904000,"contributors":[{"name":"MonoLogueChi","username":"MonoLogueChi","email":"xxwhite@foxmail.com","commits":1,"url":"https://github.com/MonoLogueChi"}]},"readingTime":{"minutes":2.31,"words":694},"filePathRelative":"2018/0203.add-download-markdown.md","excerpt":"<p>昨天给博客加了一个下载 MarkDown 文件的功能，原本是很简单的一件事，但是中间涉及到了很多麻烦东西，所以就决定简单记录以下。</p>\\n","autoDesc":true}');export{o as comp,h as data};

import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as t,b as l,e as i,d as p,w as r,r as h,o as d}from"./app-CPuZLzQp.js";const k={};function o(c,s){const a=h("RouteLink");return d(),n("div",null,[s[3]||(s[3]=t('<p>上个月花了点钱购置了一台小 jj 用作服务器，简单记录了一下装配过程，正好清明节假干完两天的活，休息一天，就写一点出来。</p><h2 id="硬件配置" tabindex="-1"><a class="header-anchor" href="#硬件配置"><span>硬件配置</span></a></h2><table><thead><tr><th style="text-align:center;">硬件</th><th style="text-align:center;">配置</th><th style="text-align:center;">价格</th></tr></thead><tbody><tr><td style="text-align:center;">机箱主板电源</td><td style="text-align:center;">惠普 800G1 小主机，Q87 主板</td><td style="text-align:center;">315</td></tr><tr><td style="text-align:center;">CPU</td><td style="text-align:center;">魔改 4870HQ</td><td style="text-align:center;">598</td></tr><tr><td style="text-align:center;">内存</td><td style="text-align:center;">二手杂牌 DDR3L 1600 * 2（有一条是从以前笔记本上拆下来的）</td><td style="text-align:center;">158 + 0</td></tr><tr><td style="text-align:center;">硬盘 0</td><td style="text-align:center;">建兴 128G mSATA 接口</td><td style="text-align:center;">146</td></tr><tr><td style="text-align:center;">硬盘 1</td><td style="text-align:center;">西数 500G（笔记本拆机）</td><td style="text-align:center;">0</td></tr><tr><td style="text-align:center;">总计</td><td style="text-align:center;"></td><td style="text-align:center;">1217</td></tr></tbody></table><p>硬件上来说就是这样了，这肯定不是最实惠的方案，也不要跟我说 XXX 更省钱了，反正我没翻车，连续开机 29 天没重启，照样跑的稳稳的。</p><p>选择机箱的时候，考虑体积价格和拓展性，最终选择了惠普的 800G1，真的很小的一个机箱<br><img src="https://s2.ax1x.com/2019/04/07/AhyDqf.jpg" alt="整体" loading="lazy"></p><p>而 CPU 在魔改 4 带 BGA 封装 U 和 E3 上权衡了很久，因为我不确定这机器上能不能上 E3，因为惠普那尿性的微码问题，包括我现在也没有解决，每次开机都要按 F1 才能进，虽然网上有人放出了修改过的微码，但是我的编程器坏了（估计是太久没用了，再加上两次搬家，旅途劳顿，挂掉了），懒得再去搞了，按 F1 就按 F1 吧。</p><figure><img src="https://s2.ax1x.com/2019/04/07/AhyBsP.jpg" alt="CPU" tabindex="0" loading="lazy"><figcaption>CPU</figcaption></figure><p>16G 内存，目前来说稍微有点浪费，但是浪费就浪费吧，但是指不定以后会在上面跑什么呢。</p><h2 id="系统" tabindex="-1"><a class="header-anchor" href="#系统"><span>系统</span></a></h2><p>先装个 Windows，测试一下整机数据，然后再去搞服务器环境</p><p>服务器系统选择没什么说的，自己一直在用 Debian，自然就直接上 Debian 了，装完之后又上了宝塔邪教，这东西很方便，因为测试环境配置什么的都要经常改，所以很适合使用宝塔，别 BB 什么什么的，我点几下，一分钟就能解决的事，有必要花五分钟去写一个配置文件嘛。</p><h2 id="网络" tabindex="-1"><a class="header-anchor" href="#网络"><span>网络</span></a></h2><p>网络的话，我这里是电信百兆，上行带宽最快能到 2M/S 这个水平吧，其中比较难解决的是外网访问问题，虽然这有公网 IP，但是没有 80 端口很难受啊，这时就想到了以前在 V2 见过的 Sakura Frp，简单记录一下使用方法</p><p>首先是注册一个账号 <a href="https://www.natfrp.org/" target="_blank" rel="noopener noreferrer">https://www.natfrp.org/</a> ；<br> 登录之后在<code>映射列表</code>里先创建一个 SSH 通道，可以参考这里<a href="https://www.zerobbs.net/thread/50" target="_blank" rel="noopener noreferrer">https://www.zerobbs.net/thread/50</a>；<br> 然后按照 <a href="https://www.zerobbs.net/thread/6" target="_blank" rel="noopener noreferrer">https://www.zerobbs.net/thread/6</a> 的方法下载客户端，解压完停下来就好，后面就不需要继续了；<br> 先测试一下连接，首先直接启动 frp 服务<code>./Sakura_frpc_linux_amd64</code> 然后会让你输入账号密码，具体参考官方论坛；<br> 上一步如果提示连接成功了，咱们再进行下一步测试，记住了自己选择的服务器和第二步选择的端口，然后连接一下 SSH 服务看一下 <code>ssh root@s21.natfrp.org -p xxxx</code> 其中 <code>s21.natfrp.org</code> 是你选择的服务器，<code>-p</code> 参数是你映射的端口，如果可以联通的话，就算是测试成功了，咱们就可以进行下一步了；<br><img src="https://s2.ax1x.com/2019/04/07/AhUbPx.png" alt="SSH连接成功" loading="lazy"><br> 后面要解决的是守护进程的问题，我曾经用两种不同的守护工具实现过，都是对应不同的实际环境，这里简单的介绍一下怎么写配置文件。</p><p>首先是 <code>Supervisor</code></p>',15)),l("p",null,[s[1]||(s[1]=i("怎么安装和使用，可以看完以前的文章")),p(a,{to:"/2018/run-dotnetcore.html"},{default:r(()=>s[0]||(s[0]=[i(".net core 程序示例")])),_:1}),s[2]||(s[2]=i("，这里简单说一下配置文件就可以了"))]),s[4]||(s[4]=t(`<div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[program:frp]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/www/frp/Sakura_frpc_linux_amd64 --</span><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">su</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">{用户名} --</span><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">{密码} --</span><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">sid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">{前面命令行启动时候的编号}</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">root</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">stopsignal</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">INT</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">autostart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">autorestart</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">true</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">startsecs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">stderr_logfile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/www/frp/frp.log</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">stdout_logfile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/www/frp/frp.out.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>里面的变量替换成你自己的（没用括号），路径也换成你自己的</p><p>另一种方法是用 <code>PM2</code></p><p>首先宝塔面板自带了 pm2 管理器，可以在软件管理里直接安装，如果没用使用宝塔面板的话，可以选择先安装 Node 和 npm，然后用 npm 安装 pm2，具体怎么安装，可以百度</p><p>在 frp 解压的目录下新建一个文本文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /xxxxxxxxxx</span></span>
<span class="line"><span>touch ./frp.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后修改配置文件 <code>vim ./frp.json</code></p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  &quot;apps&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;frp&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;script&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Sakura_frpc_linux_amd64&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;cwd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/www/frp/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;autorestart&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;node_args&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;args&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;--su=用户名&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;--sp=密码&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;--sid=8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      &quot;env&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中<code>script</code>是要执行的命令，<code>cwd</code>是路径，换成你自己的，后面的参数同样换成你自己的，写好之后</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>pm2 start frp.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>再确定一下有没有启动</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>pm2 list</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pm2 show 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://s2.ax1x.com/2019/04/07/AhDPv6.png" alt="pm2状态" tabindex="0" loading="lazy"><figcaption>pm2状态</figcaption></figure><p>再次用 ssh 连接测试，看看能不能在外网连上，如果没问题的话，守护进程的问题就算是解决了。</p><p>再添加几条隧道，比如 http 和 https 隧道，这里就不再啰嗦了，按照官方论坛上的教程来就可以了。</p><h2 id="服务" tabindex="-1"><a class="header-anchor" href="#服务"><span>服务</span></a></h2><p>目前这台小 JJ 主要用来测试，搭建了几个比较简单的服务，直播服务（主要在局域网内测试），二维码生成服务 <a href="https://qr.sm9.top/api/qr?tt=%E5%8F%82%E6%95%B0" target="_blank" rel="noopener noreferrer">https://qr.sm9.top/api/qr?tt=参数</a>，函数图像生成服务（自己测试使用，还没写完），以及日常开发过程中的测试</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>闲的蛋疼，又搞了台机器回来吃灰了。</p>`,19))])}const u=e(k,[["render",o]]),y=JSON.parse('{"path":"/2019/04070.small-jj.html","title":"又入手一台小JJ","lang":"zh-CN","frontmatter":{"title":"又入手一台小JJ","date":"2019-04-07T16:30:09.000Z","tag":["建站笔记","随便水水"],"keywords":"Sakura Frp, 守护进程, PM2, Supervisor","comments":true,"redirectFrom":["/2019/small-jj.html"],"description":"上个月花了点钱购置了一台小 jj 用作服务器，简单记录了一下装配过程，正好清明节假干完两天的活，休息一天，就写一点出来。","head":[["meta",{"property":"og:url","content":"https://blog.u2sb.com/2019/04070.small-jj.html"}],["meta",{"property":"og:site_name","content":"叉叉白"}],["meta",{"property":"og:title","content":"又入手一台小JJ"}],["meta",{"property":"og:description","content":"上个月花了点钱购置了一台小 jj 用作服务器，简单记录了一下装配过程，正好清明节假干完两天的活，休息一天，就写一点出来。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://s2.ax1x.com/2019/04/07/AhyDqf.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-06T06:29:45.000Z"}],["meta",{"property":"article:tag","content":"建站笔记"}],["meta",{"property":"article:tag","content":"随便水水"}],["meta",{"property":"article:published_time","content":"2019-04-07T16:30:09.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-06T06:29:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"又入手一台小JJ\\",\\"image\\":[\\"https://s2.ax1x.com/2019/04/07/AhyDqf.jpg\\",\\"https://s2.ax1x.com/2019/04/07/AhyBsP.jpg\\",\\"https://s2.ax1x.com/2019/04/07/AhUbPx.png\\",\\"https://s2.ax1x.com/2019/04/07/AhDPv6.png\\"],\\"datePublished\\":\\"2019-04-07T16:30:09.000Z\\",\\"dateModified\\":\\"2025-04-06T06:29:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MonoLogueChi\\",\\"url\\":\\"https://blog.u2sb.com\\"}]}"]]},"git":{"createdTime":1743920985000,"updatedTime":1743920985000,"contributors":[{"name":"MonoLogueChi","username":"MonoLogueChi","email":"xxwhite@foxmail.com","commits":1,"url":"https://github.com/MonoLogueChi"}]},"readingTime":{"minutes":4.65,"words":1394},"filePathRelative":"2019/04070.small-jj.md","localizedDate":"2019年4月8日","excerpt":"<p>上个月花了点钱购置了一台小 jj 用作服务器，简单记录了一下装配过程，正好清明节假干完两天的活，休息一天，就写一点出来。</p>\\n","autoDesc":true}');export{u as comp,y as data};

import{_ as l,a as e}from"./Snipaste_2020-05-16_18-17-50-CphRmO6k.js";import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,a,b as h,e as i,d as k,w as r,r as d,o}from"./app-Ct1uGNWU.js";const c={};function A(g,s){const n=d("RouteLink");return o(),p("div",null,[s[3]||(s[3]=a('<p>使用 GitHub Actions CI 将博客部署到又拍云。</p><p>网上文章不多，我就自己写一遍。</p><blockquote><p>这东西别迷信什么权威，正所谓猫有猫道，狗有狗道，每个人的习惯不一样，做法也不一样，但最后的效果都差不多。别看谁和谁说的不一样，就认为一定有一个错的。</p></blockquote><h2 id="创建操作员" tabindex="-1"><a class="header-anchor" href="#创建操作员"><span>创建操作员</span></a></h2><p>在云存储仓库可以正常使用的情况下，在 <code>存储管理</code> 的最后面找到 <code>操作员授权</code> 新建一个操作员<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup></p><figure><img src="'+l+'" alt="操作员授权" tabindex="0" loading="lazy"><figcaption>操作员授权</figcaption></figure><figure><img src="'+e+'" alt="操作员授权" tabindex="0" loading="lazy"><figcaption>操作员授权</figcaption></figure><p>记录下操作员账号和密码。</p><h2 id="添加密钥" tabindex="-1"><a class="header-anchor" href="#添加密钥"><span>添加密钥</span></a></h2>',9)),h("p",null,[s[1]||(s[1]=i("参考 ")),k(n,{to:"/2022/03090.%E4%BD%BF%E7%94%A8CI%E5%B0%86%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E5%88%B0GitHub.html#%E6%B7%BB%E5%8A%A0%E7%A7%81%E9%92%A5%E5%88%B0-actions-secrets"},{default:r(()=>s[0]||(s[0]=[i("添加私钥到 Actions Secrets")])),_:1}),s[2]||(s[2]=i("，添加"))]),s[4]||(s[4]=a(`<ul><li>UP_BUCKET : 存储服务名称</li><li>UP_OPERATOR : 操作员</li><li>UP_OPERATOR_PASSWORD : 操作员密码</li></ul><h2 id="编辑-ci-文件" tabindex="-1"><a class="header-anchor" href="#编辑-ci-文件"><span>编辑 CI 文件</span></a></h2><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># .github/workflows/deploy.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">deploy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在main分支发生push事件时触发。</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    branches</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">main</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">env</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置环境变量</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  TZ</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Asia/Shanghai</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 时区（设置时区可使页面中的\`最近更新时间\`使用时区时间）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jobs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  build</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    runs-on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ubuntu-latest</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 运行在虚拟机环境ubuntu-latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    steps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 检出</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">actions/checkout@v2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 安装 node</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Setup Node</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">actions/setup-node@v3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          node-version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;16.x&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          registry-url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://registry.npmjs.org&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          cache</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;yarn&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 构建</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Build</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          yarn install</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          yarn build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 同步到又拍云</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Deploy upyun</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          wget -O upx.tar.gz http://collection.b0.upaiyun.com/softwares/upx/upx_0.3.6_linux_x86_64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          tar -zxf upx.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          chmod +x upx</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          ./upx login \${{ secrets.UP_BUCKET }} \${{ secrets.UP_OPERATOR }} \${{ secrets.UP_OPERATOR_PASSWORD }}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          ./upx sync dist/ / --delete</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          ./upx logout</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="测试" tabindex="-1"><a class="header-anchor" href="#测试"><span>测试</span></a></h2><p>推送到 GitHub，等待 CI 执行完成，观察又拍云仓库文件变化，测试网页是否更新。</p><h2 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h2><p>请勿保存操作员密码，这东西留着没用，反而是隐患，正确的做法应该是，单独使用一个操作员，重新配置时忘记密码就直接换新的操作员。</p><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://help.upyun.com/knowledge-base/cdn-operator/" target="_blank" rel="noopener noreferrer">关于操作员的使用说明</a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li></ol></section>`,10))])}const B=t(c,[["render",A]]),v=JSON.parse('{"path":"/2022/03091.%E4%BD%BF%E7%94%A8CI%E5%B0%86%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E5%88%B0%E5%8F%88%E6%8B%8D%E4%BA%91.html","title":"使用 GitHub Actions 将博客部署到又拍云","lang":"zh-CN","frontmatter":{"title":"使用 GitHub Actions 将博客部署到又拍云","date":"2022-03-09T14:20:33.000Z","tag":["建站笔记"],"comments":true,"redirectFrom":["/pages/6f0a75/"],"description":"使用 GitHub Actions CI 将博客部署到又拍云。","head":[["meta",{"property":"og:url","content":"https://blog.u2sb.com/2022/03091.%E4%BD%BF%E7%94%A8CI%E5%B0%86%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2%E5%88%B0%E5%8F%88%E6%8B%8D%E4%BA%91.html"}],["meta",{"property":"og:site_name","content":"叉叉白"}],["meta",{"property":"og:title","content":"使用 GitHub Actions 将博客部署到又拍云"}],["meta",{"property":"og:description","content":"使用 GitHub Actions CI 将博客部署到又拍云。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-06T11:04:02.000Z"}],["meta",{"property":"article:tag","content":"建站笔记"}],["meta",{"property":"article:published_time","content":"2022-03-09T14:20:33.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-06T11:04:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"使用 GitHub Actions 将博客部署到又拍云\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-03-09T14:20:33.000Z\\",\\"dateModified\\":\\"2025-04-06T11:04:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MonoLogueChi\\",\\"url\\":\\"https://blog.u2sb.com\\"}]}"]]},"git":{"createdTime":1743937442000,"updatedTime":1743937442000,"contributors":[{"name":"MonoLogueChi","username":"MonoLogueChi","email":"xxwhite@foxmail.com","commits":1,"url":"https://github.com/MonoLogueChi"}]},"readingTime":{"minutes":1.7,"words":509},"filePathRelative":"2022/03091.使用CI将博客部署到又拍云.md","localizedDate":"2022年3月9日","excerpt":"<p>使用 GitHub Actions CI 将博客部署到又拍云。</p>\\n","autoDesc":true}');export{B as comp,v as data};

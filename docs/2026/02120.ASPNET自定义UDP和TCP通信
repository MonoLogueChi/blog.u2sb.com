---
title: ASPNET自定义UDP和TCP通信
date: 2024-03-03 16:37:00
keywords: ["C#", ".net", "路由"]
tag:
  - C#
---

最近的工作中实际遇到并解决的问题，需要使用UDP和TCP通信，最好能像http一样直接注册 Controller ，简单记录一下解决思路。

<!-- more -->

## 问题关键

关键点还是在依赖注入上，需要将所有 controller 注入到服务，然后根据路由去做解析，对性能要求不高，但是需要实现方便。

思路是使用反射，在服务初始化时，扫一遍程序集，然后生成一个 路由-控制器 的字典，然后将所有控制器注入，然后在需要的时候通过路由从字典中获得控制器的类型，然后再通过类型调用对应的控制器。

但是这样实现也有局限性，路由只能定义到控制器类，而不能像 http 的控制器一样，让每个方法写 GET 或者 POST。不过问题也不大，够用了。

## 实现

话不多说，直接上代码。